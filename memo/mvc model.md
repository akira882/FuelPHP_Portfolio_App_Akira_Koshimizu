---
title: "MVCアーキテクチャの役割分担とデータフローの理解

# 概要 (Overview)
Webアプリケーション開発における標準的な設計手法である**MVCモデル（Model-View-Controller）**について学習した。
アプリケーションの責務を「データ処理」「表示」「制御」の3つに分割することで、コードの可読性を高め、チーム開発における分業や保守運用を容易にする目的がある。

# MVCの各役割と実装詳細

FuelPHPにおけるディレクトリ構造と合わせて整理する。

## 1. Model（データロジック担当）
*   **定義**: ビジネスロジックとデータアクセスを担う層。
*   **役割**: 
    *   データベース（MySQL等）へのCRUD操作（Create, Read, Update, Delete）。
    *   データの加工、計算、バリデーションルールの一部。
    *   **Controllerから指示を受け、結果を返す**ことだけに集中する。
*   **File Path**: `fuel/app/classes/model/`

## 2. View（ユーザーインターフェース担当）
*   **定義**: ユーザーが実際に目にする画面（UI）を生成する層。
*   **役割**:
    *   Controllerから渡された変数（データ）をHTMLに埋め込んで表示する。
    *   **重要**: ここに複雑な計算やDB接続などのロジックを記述してはならない（保守性が下がるため）。
*   **File Path**: `fuel/app/views/`

## 3. Controller（司令塔・制御担当）
*   **定義**: ユーザーからのリクエストを受け取り、ModelとViewを連携させる層。
*   **役割**:
    *   **Input**: ユーザーの入力（URLパラメータやフォームデータ）を受け取る。
    *   **Process**: Modelを呼び出して必要なデータを取得・保存させる。
    *   **Output**: 取得したデータをViewに渡し、最終的なレスポンス（画面）をブラウザに返す。
*   **File Path**: `fuel/app/classes/controller/`

---

# 処理のフロー（Request to Response）

ユーザーがブラウザでアクセスしてから、画面が表示されるまでの流れを整理する。

1.  **Request**: ユーザーがURLにアクセス（例: `/users/index`）。
2.  **Routing**: ルーターがURLを解析し、適切な**Controller**を呼び出す。
3.  **Controller**: 
    *   「ユーザー一覧が欲しい」と判断し、**Model**にデータを要求する。
4.  **Model**: 
    *   データベースへSQLを発行し、ユーザー情報を取得してControllerへ返す。
5.  **Controller**: 
    *   受け取ったデータを**View**へ渡す。
6.  **View**: 
    *   HTMLの中にデータを埋め込み、Webページを生成する。
7.  **Response**: 完成したHTMLがユーザーのブラウザに表示される。

---

# 学び・考察 (Insight)

## なぜ「ファイルを分ける」のか？
学習当初は「1つのファイルに全部書いた方が楽ではないか？」と考えたが、以下の理由からMVCによる分離が不可欠であると理解した。

1.  **保守性の向上**: 「デザインを変えたい」ならView、「計算式を変えたい」ならModelと、修正箇所が明確になる。バグ発生時の切り分けも容易になる。
2.  **チーム開発の効率化**: コアテック社のようなチーム開発において、フロントエンドエンジニアがViewを、バックエンドエンジニアがModel/Controllerを担当するといった並行作業が可能になる。
3.  **認知的負荷の低減**: 1つのファイルに全ての処理が書かれているとコードが複雑化するが、分割されていれば「今はデータのことを考える」と集中できる（これは高次脳機能障害の特性を持つ私にとっても、非常に有効な設計思想である）。

## 今後のアクション
現在開発中のFuelPHPアプリにおいて、ControllerにSQL処理を直書きしてしまっている箇所があるため、早急にModelクラスへ切り出しを行い、**「Fat Controller」**の解消に取り組む。
